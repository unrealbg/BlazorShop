@if (IsVisible)
{
    <ModalDialog @bind-IsVisible="IsVisible" OnClose="CloseModal" Size="xl" CloseOnBackdrop="true" ShowCloseButton="true">
        <Header>
            <div class="flex items-center justify-between w-full">
                <div class="flex items-center gap-3">
                    <div class="h-7 w-7 grid place-items-center rounded-md bg-white/10 text-white/90">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7h18M3 12h18M3 17h18"/></svg>
                    </div>
                    <h5 class="text-base sm:text-lg font-semibold">@Product?.Name</h5>
                </div>
                <div class="text-sm font-semibold bg-white/10 rounded px-2 py-0.5">€ @DisplayedPrice</div>
            </div>
        </Header>
        <Body>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="relative aspect-[4/3] overflow-hidden rounded-xl bg-neutral-50">
                    <img src="@Product?.Image" alt="@Product?.Name" class="absolute inset-0 w-full h-full object-contain" />
                </div>
                <div class="flex flex-col gap-3 text-sm text-neutral-700">
                    <p>@Product?.Description</p>

                    @if (Product?.Variants?.Any() == true)
                    {
                        <div>
                            <label class="block text-xs text-neutral-600 mb-1">Size</label>
                            <select class="w-full border rounded px-3 py-2" @onchange="OnVariantChanged">
                                <option value="">-- Select size --</option>
                                @foreach (var v in Product.Variants)
                                {
                                    <option value="@v.Id">@v.SizeValue (@ScaleLabel(v.SizeScale)) @(v.Price.HasValue ? $"- € {v.Price}" : string.Empty)</option>
                                }
                            </select>
                        </div>
                    }

                    <div class="mt-2">
                        <div class="text-sm text-neutral-500">Price</div>
                        <div class="text-2xl font-extrabold">€ @DisplayedPrice</div>
                    </div>
                </div>
            </div>
        </Body>
        <Footer>
            <div class="flex items-center justify-end gap-2">
                <button class="inline-flex items-center rounded bg-neutral-900 text-white px-4 py-2 font-semibold hover:bg-neutral-800 disabled:opacity-50" @onclick="HandleAddToCart" disabled="@IsAddDisabled">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M6 6h15l-1.5 9h-12z"/><path d="M6 6 5 3H3"/></svg>
                    Add to Cart
                </button>
                <button class="inline-flex items-center rounded bg-neutral-200 text-neutral-900 px-4 py-2 font-semibold hover:bg-neutral-300" @onclick="CloseModal">Close</button>
            </div>
        </Footer>
    </ModalDialog>
}

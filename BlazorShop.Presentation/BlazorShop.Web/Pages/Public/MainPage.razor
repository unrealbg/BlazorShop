@page "/main/products/category/{categoryId}"
@implements IAsyncDisposable

@if (SelectedCategory != null && _productsByCategory.Any())
{
    <section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-10 pb-12">
        <h2 class="text-3xl font-extrabold tracking-tight text-center">@SelectedCategory!.Name Products</h2>
        <div class="mt-8 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
            @foreach (var product in _productsByCategory)
            {
                <article class="group relative rounded-2xl bg-white/95 border border-neutral-200/70 shadow-md hover:shadow-2xl transition-all duration-300 overflow-hidden hover:-translate-y-0.5">
                    <div class="p-6">
                        <div class="flex items-start justify-between">
                            <h4 class="text-lg font-extrabold text-neutral-900">@product.Name</h4>
                            @if (product.IsNew)
                            {
                                <span class="inline-block text-[10px] font-semibold text-white bg-green-600/90 px-2 py-0.5 rounded">NEW</span>
                            }
                        </div>
                        <p class="mt-1 text-[15px]"><span class="text-rose-600 font-semibold">Price</span> <span class="font-semibold">€ @product.Price</span></p>
                        <div class="mt-4 relative aspect-[4/3] overflow-hidden rounded-xl bg-neutral-50">
                            <img src="@product.Image" alt="@product.Name" class="absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-out group-hover:scale-105" />
                        </div>
                    </div>
                    <div class="flex items-center justify-between px-6 pb-5 border-t border-neutral-100 text-sm">
                        <button class="inline-flex items-center gap-2 rounded-md bg-neutral-900 text-white px-3 py-1.5 font-medium hover:bg-neutral-800" @onclick="() => AddItemToCart(product.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M6 6h15l-1.5 9h-12z"/><path d="M6 6 5 3H3"/></svg>
                            Add To Cart
                        </button>
                        <button class="inline-flex items-center gap-2 rounded-md px-3 py-1.5 text-neutral-700 hover:text-neutral-900 hover:bg-neutral-100" @onclick="() => ShowDetails(product)">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12Z"/></svg>
                            See More
                        </button>
                    </div>
                </article>
            }
        </div>
    </section>
}
else
{
    <section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-10 pb-12">
        <div class="mt-10 flex justify-center">
            <div class="rounded-md bg-blue-50 text-blue-800 px-6 py-5 text-center shadow">
                No products found in this category
            </div>
        </div>
        <div class="mt-6 text-center">
            <a href="/" class="inline-flex items-center rounded bg-amber-500 text-white px-4 py-2 font-semibold hover:bg-amber-600">Go Back to Home</a>
        </div>
    </section>
}

<ProductDetails Product="SelectedProduct"
                IsVisible="_showModal"
                OnClose="CloseDetails"
                OnAddToCart="AddItemToCart" />